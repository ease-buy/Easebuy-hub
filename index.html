<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Campus Business Network</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100 text-gray-800">

  <!-- Header -->
  <header class="bg-gradient-to-r from-green-500 to-blue-500 text-white p-4">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-2xl font-bold">Campus Business Network</h1>
      <nav>
        <ul class="flex space-x-4 items-center">
          <li><a href="index.html" class="hover:underline font-bold">Home</a></li>
          <li><a href="Contact-us.html" class="hover:underline">Contact Us</a></li>
          <li><a href="admin.html" class="hover:underline">Admin</a></li>
          <li>
            <a href="cart.html" class="hover:underline font-bold">
              Cart (<span id="cart-count">0</span>)
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Products -->
  <section class="container mx-auto px-4 py-10">
    <h2 class="text-2xl font-bold mb-6">Available Products</h2>

    <!-- Search -->
    <div class="mb-6">
      <input 
        type="text" 
        id="search-input"
        placeholder="Search products..."
        class="w-full md:w-1/2 border border-gray-300 p-3 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500"
      >
    </div>

    <div id="product-list" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-4">
    <div class="container mx-auto px-4 text-center">
      <p>&copy; 2026 Campus Business Network. All rights reserved.</p>
    </div>
  </footer>

<script>

  const productList = document.getElementById('product-list');
  const searchInput = document.getElementById('search-input');

  let cart = JSON.parse(localStorage.getItem('cbn-cart')) || [];

  function updateCartCount() {
    const count = cart.reduce((acc, item) => acc + item.qty, 0);
    document.getElementById('cart-count').textContent = count;
  }

  function addToCart(index) {
    const products = JSON.parse(localStorage.getItem('cbn-products')) || [];
    const product = products[index];

    const existing = cart.find(item => item.name === product.name);

    if (existing) {
      existing.qty += 1;
    } else {
      cart.push({
        name: product.name,
        price: product.price,
        qty: 1
      });
    }

    localStorage.setItem('cbn-cart', JSON.stringify(cart));
    updateCartCount();
    alert("Added to cart!");
  }

  function loadProducts(filter = "") {
    const products = JSON.parse(localStorage.getItem('cbn-products')) || [];
    productList.innerHTML = '';

    const filteredProducts = products.filter(product => {
      const searchText = filter.toLowerCase();

      const nameMatch = product.name.toLowerCase().includes(searchText);
      const categoryMatch = product.category.toLowerCase().includes(searchText);

      const specsMatch = product.specs
        ? product.specs.join(" ").toLowerCase().includes(searchText)
        : false;

      return nameMatch || categoryMatch || specsMatch;
    });

    if (filteredProducts.length === 0) {
      productList.innerHTML = '<p class="text-gray-500">No matching products found.</p>';
      return;
    }

    filteredProducts.forEach((product) => {

      const originalIndex = products.indexOf(product);

      // ✅ Functional specs dropdown
      let specsDropdown = "";
      if (product.specs && product.specs.length > 0) {
        specsDropdown = `
          <select
            class="border p-2 rounded w-full mb-3 text-sm bg-white cursor-pointer"
            onchange="this.selectedIndex = 0">
            <option>Specifications</option>
            ${product.specs.map(spec =>
              `<option>${spec}</option>`
            ).join("")}
          </select>
        `;
      }

      const div = document.createElement('div');
      div.className = 'bg-white p-4 rounded shadow text-center';

      div.innerHTML = `
        <img src="${product.image}" class="w-full h-40 object-cover rounded mb-2">
        <h4 class="font-semibold text-lg">${product.name}</h4>
        <p class="text-gray-500">₵${product.price}</p>
        <p class="text-sm text-blue-600 font-semibold mb-2">${product.category}</p>
        ${specsDropdown}
        <button onclick="addToCart(${originalIndex})"
          class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded w-full">
          Add to Cart
        </button>
      `;

      productList.appendChild(div);
    });
  }

  searchInput.addEventListener('input', function() {
    loadProducts(this.value);
  });

  loadProducts();
  updateCartCount();

</script>

</body>
</html>
